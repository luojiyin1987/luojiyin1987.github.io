<!DOCTYPE html>
<html lang="zh-cn">
<head>
        <meta charset="utf-8" />
        <title>记录自己的想法 - misc</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">记录自己的想法 </a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/misc.html">misc</a></li>
                    <li><a href="/category/wen-zhang-lei-bie.html">文章类别</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/io.html">I/O</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-05-25T00:00:00+02:00">
                Published: 三 25 五月 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/luojiyin.html">luojiyin</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info --><h1>I/O</h1>
<p>缓存I/O也被称为标准I/O，大多数文件系统的默认I/O是缓存I/O。在Linux缓存I/O机制中，将I/O数据缓存在文件系统中的页缓存（page cache）中，即数据先拷贝到Linux内核缓冲区中，然后才从Linux内核缓冲区拷贝到应用程序的地址空间。</p>
<h2>缓存I/O的优点</h2>
<p>缓存I/O使用了Linux内核缓冲区，在一定程度上分离了应用程序空间和实际的物理设备。
减少了读盘次数，提高性能。</p>
<h2>不同的写入方式</h2>
<p>如果用户使用同步写（synchronous writes）,数据将立刻写到磁盘上，应用程序会等到数据写完。
如果是延迟写（deferred writes）,应用程序就不需要等到数据完全写到磁盘，只要数据写入到缓存中，在延迟写下， Linux会定期将页缓存（page cache）的数据写到磁盘上。
与异步写（asynchronous writes） 不同的是，延迟写机制在数据完全写到磁盘上时不会通知应用程序，异步写机制会在数据完全写到磁盘上通知应用程序。延迟写存在数据丢失的风险（拔出U盘时侯，一定要通知系统，不要直接拔，否则有文件数据没写入，血的教训）</p>
<h2>缓存I/O的缺点</h2>
<p>在缓存I/O机制中，DMA方式可以将数据从磁盘读取到页缓存中（page cache）,或者将数据从页缓存（page cache） 直接写到磁盘上，而不能直接在应用程序地址空间和磁盘上。这样数据在传输过程中需要在应用程序地址空间和页缓存之间进行多次数据拷贝操作。带来CPU和内存开销非常大。</p>
<h2>直接I/O</h2>
<p>直接I/O通过减少Linux内核缓冲区和应用程序地址空间的数据拷贝次数，降低对文件读取和写入带来的CPU和内存带宽的占用。</p>
<h2>直接I/O  带来的潜在问题</h2>
<p>设置直接I/O的开销很大，直接不能提供缓存I/O的优势。直接I/O读数据会造成磁盘的同步读，带来性能的下降，进程较长时间才能执行完。写数据，直接I/O 需要调用 write() 系统调用同步执行，否则应用程序会不知道什么时侯才可以使用缓冲I/O。直接I/O也会导致应用程序关闭缓慢。</p>
<p>所以应用程序使用直接I/O进行数据传输时侯通常会使用异步I/O结合使用</p>
<h2>网络I/O</h2>
<p>不太明白  待解决</p>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>